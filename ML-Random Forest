import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_squared_error, r2_score

# Load the dataset
data = pd.read_csv('/content/sample_data/california_housing_test.csv')
# Select an independent variable and the dependent variable
X = data.loc[0:5, ["housing_median_age"]]
y = data.loc[0:5, "latitude"]

# Create a Random Forest regression model
n_estimators = 100  # Number of decision trees in the forest (adjust as needed)
model = RandomForestRegressor(n_estimators=n_estimators)

# Fit the model to the data
model.fit(X, y)

# Predict using the trained model
y_pred = model.predict(X)

# Calculate Mean Squared Error (MSE) and R-squared
mse = mean_squared_error(y, y_pred)
r_squared = r2_score(y, y_pred)

print("Mean Squared Error (MSE):", mse)
print("R-squared (Coefficient of Determination):", r_squared)

# Create a scatter plot of actual vs. predicted values
plt.scatter(X, y, color='blue', label='Actual')
plt.scatter(X, y_pred, color='red', label='Predicted')
plt.xlabel("Housing Median Age")
plt.ylabel("Latitude")
plt.title("Random Forest Regression")
plt.legend()
plt.show()
